DATA <- read.csv("../編集用ファイル/過去5年間の資源量等.csv")
head(DATA)
THISYEAR        <- 2016
REVIEW_RANGE_yr <- 5
YEAR_START  <- THISYEAR - REVIEW_RANGE_yr + 1
YEAR_START
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
YEARS           <- YEAR_START:THISYEAR
YEARS
colnames(ALLDATA) <- c("Year","StockBiomass_ThousandTon","SSB_ThousandTon","Catch_ThousandTon","F","CatchRatio_percent")
ALLDATA         <- read.csv("../編集用ファイル/過去5年間の資源量等.csv")
colnames(ALLDATA) <- c("Year","StockBiomass_ThousandTon","SSB_ThousandTon","Catch_ThousandTon","F","CatchRatio_percent")
DATA_FOR_TABLE  <- subset(ALLDATA, Year %in% YEARS)
DATA_FOR_TABLE
DATA_FOR_TABLE  <- subset(ALLDATA, Year %in% YEARS); DATA_FOR_TABLE <- DATA_FOR_TABLE[order(DATA_FOR_TABLE$Year),]
DATA_FOR_TABLE
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
out <- "\過去5年間の資源量等"
out <- "\\過去5年間の資源量等"
out
out <- "\\\過去5年間の資源量等"
out <- "\過去5年間の資源量等"
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
nrow(DATA_FOR_TABLE)
out <- "\\過去5年間の資源量等"
for(i in nrow(DATA_FOR_TABLE)){
for(j in ncol(DATA_FOR_TABLE)){
out <- paste(out, "{",sep="")
out <- paste(out, DATA_FOR_TABLE[i,j],sep="")
out <- paste(out, "}",sep="")
}
}
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
newdata
out     <- paste(out, newdata, sep="")
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
j==
j
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
ijdata
ijdata
DATA_FOR_TABLE[i,j]
ijdata
is.na(ijdata)
ijdata
ijdata <- DATA_FOR_TABLE[i,j]
ijdata
is.na(ijdata)
is.na(ijdata)==T
"--"
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/TeX表に書き出し_過去5年間の資源量等.R', echo=TRUE)
out
source('~/Dropbox/Projects/170630TeX移行/TeX移行_Rsources/Rスクリプト一括実行.R', echo=TRUE)
library(XLConnect)
WB      <- loadWorkbook("../DIGEST.xlsx")
SHEETS  <- getSheets(WB)
SHEETS
readWorksheet(WB,sheet=SHEETS[1])
readWorksheet(WB,sheet=SHEETS[1])
HONBUN  <- readWorksheet(WB,sheet=SHEETS[1])
head(HONBUN)
SPCS_NAME_JP <- HONBUN[4,2]
SPCS_NAME_JP
HONBUN  <- readWorksheet(WB,sheet=SHEETS[1], header=F)
head(HONBUN)
SPCS_NAME_JP <- HONBUN[4,2]
(SPCS_NAME_JP <- HONBUN[4,2])
(SPCS_NAME <- HONBUN[5,2])
BLOCK1 <- "<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<title>03マアジ太平洋系群ダイジェスト版</title>
<link rel="Stylesheet" type="text/css" href="../cmn/scr_style.css">
<link rel="Stylesheet" type="text/css" href="../cmn/prt_style.css" media="print">
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-4451830-1");
pageTracker._initData();
pageTracker._trackPageview();
</script>
"
BLOCK1 <- "<html>
<head>
<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">
<title>03マアジ太平洋系群ダイジェスト版</title>
<link rel=\"Stylesheet\" type=\"text/css\" href=\"../cmn/scr_style.css\">
<link rel=\"Stylesheet\" type=\"text/css\" href=\"../cmn/prt_style.css\" media=\"print\">
<script type=\"text/javascript\">
var gaJsHost = ((\"https:\" == document.location.protocol) ? \"https://ssl.\" : \"http://www.\");
document.write(unescape(\"%3Cscript src='\" + gaJsHost + \"google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E\"));
</script>
<script type=\"text/javascript\">
var pageTracker = _gat._getTracker(\"UA-4451830-1\");
pageTracker._initData();
pageTracker._trackPageview();
</script>
"
BLOCK1 <- "<html>
<head>
<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">
<title>03マアジ太平洋系群ダイジェスト版</title>
<link rel=\"Stylesheet\" type=\"text/css\" href=\"../cmn/scr_style.css\">
<link rel=\"Stylesheet\" type=\"text/css\" href=\"../cmn/prt_style.css\" media=\"print\">
<script type=\"text/javascript\">
var gaJsHost = ((\"https:\" == document.location.protocol) ? \"https://ssl.\" : \"http://www.\");
document.write(unescape(\"%3Cscript src='\" + gaJsHost + \"google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E\"));
</script>
<script type=\"text/javascript\">
var pageTracker = _gat._getTracker(\"UA-4451830-1\");
pageTracker._initData();
pageTracker._trackPageview();
</script>
"
BLOCK1
write.table(BLOCK1, "../output/BLOCK1.html",row.names = F, col.names = F)
BLOCK1 <- "<html>
<head>
<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">
<title>SPCS_NAME_JP STOCK_NAMEダイジェスト版</title>
<link rel=\"Stylesheet\" type=\"text/css\" href=\"../cmn/scr_style.css\">
<link rel=\"Stylesheet\" type=\"text/css\" href=\"../cmn/prt_style.css\" media=\"print\">
<script type=\"text/javascript\">
var gaJsHost = ((\"https:\" == document.location.protocol) ? \"https://ssl.\" : \"http://www.\");
document.write(unescape(\"%3Cscript src='\" + gaJsHost + \"google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E\"));
</script>
<script type=\"text/javascript\">
var pageTracker = _gat._getTracker(\"UA-4451830-1\");
pageTracker._initData();
pageTracker._trackPageview();
</script>
"
BLOCK1
gsub("SPCS_NAME ", SPCS_NAME_JP, BLOCK1)
gsub("SPCS_NAME ", SPCS_NAME_JP, BLOCK1)
SPCS_NAME_JP
gsub("SPCS_NAME ", SPCS_NAME_JP, BLOCK1)
gsub("SPCS_NAME ", as.character(SPCS_NAME_JP), BLOCK1)
gsub("SPCS_NAME_JP ", eval(SPCS_NAME_JP), BLOCK1)
gsub("SPCS_NAME_JP ", SPCS_NAME_JP, BLOCK1)
STOCK_NAME    <- HONBUN[6,2]
BLOCK1
gsub("SPCS_NAME_JP ", SPCS_NAME_JP, BLOCK1)
gsub("SPCS_NAME_JP ", SPCS_NAME_JP, gsub("STOCK_NAME", STOCK_NAME, BLOCK1)))
gsub("SPCS_NAME_JP ", SPCS_NAME_JP, gsub("STOCK_NAME", STOCK_NAME, BLOCK1))
write.table(BLOCK1, "../output/BLOCK1.html",row.names = F, col.names = F)
write.table(BLOCK1, "../output/BLOCK1.html",row.names = F, col.names = F, quote = F)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
TANTOUSHA
TANTOUSUIKEN        <- HONBUN[7,2]
TANTOUSHA           <- HONBUN[8,2]
TANTOUSHA
LIFESPAN            <- HONBUN[9,2]
LIFESPAN
LIFESPAN            <- HONBUN[10,2]
LIFESPAN
LIFESPAN            <- HONBUN[10,COLPOS_THISYEAR]
COLPOS_THISYEAR     <- 4
LIFESPAN            <- HONBUN[10,COLPOS_THISYEAR]
LIFESPAN
LIFESPAN            <- HONBUN[11,COLPOS_THISYEAR]
LIFESPAN
AGE_AT_1ST_MATURITY <- HONBUN[12,COLPOS_THISYEAR]
AGE_AT_1ST_MATURITY
FORAGING_SEAS_GRD   <- HONBUN[14,COLPOS_THISYEAR]
FORAGING_SEAS_GRD
SPAWNING_SEAS_GRD   <- HONBUN[13,COLPOS_THISYEAR]
SPAWNING_SEAS_GRD
PREDATOR            <- HONBUN[16,COLPOS_THISYEAR]
PREDATOR
FEEDING_ECOLOGY     <- HONBUN[15,COLPOS_THISYEAR]
FEEDING_ECOLOGY
source('~/Dropbox/Projects/170630TeX移行/ダイジェスト版/ダイジェスト版_Rsources/エクセルをhtmlに.R', echo=TRUE)
